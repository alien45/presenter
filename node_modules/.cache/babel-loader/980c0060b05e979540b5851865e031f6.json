{"ast":null,"code":"import _slicedToArray from\"/home/toufiq/go/src/github.com/play-around/presenter/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import client from'./client';import'./App.css';export default function App(){var _useState=useState(localStorage.getItem('password')),_useState2=_slicedToArray(_useState,2),password=_useState2[0],setPassword=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),slideIndex=_useState4[0],setSlideIndexOrg=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),slides=_useState6[0],setSlides=_useState6[1];// slide names\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isPresenter=_useState8[0],setIsPresenter=_useState8[1];var DO_PRESENT=getUrlParam('present').toLowerCase()==='yes';var setSlideIndex=function setSlideIndex(index){window.slideIndex=index;setSlideIndexOrg(index);};var handleLogin=deferred(function(){client.login(password,function(_,admin,slides,index){if(password){setIsPresenter(admin);if(admin){localStorage.setItem('password',password);setupKeyHandler(slides.length);}}setSlides(slides||[]);setSlideIndex(index);});},100);useEffect(function(){handleLogin();client.onSlideIndex(function(index){setSlideIndex(index);console.log('Slide changed',index);});client.onReconnect(function(){slides.length===0&&client.getSlides(function(slides){return setSlides(slides||[]);});isPresenter&&password&&handleLogin();});return function(){};},[]);if(DO_PRESENT&&!isPresenter&&!localStorage.getItem('password'))return/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'center'}},/*#__PURE__*/React.createElement(\"h3\",null,\"Please enter password to login\"),/*#__PURE__*/React.createElement(\"form\",{onSubmit:function onSubmit(e){return e.preventDefault()|handleLogin();}},/*#__PURE__*/React.createElement(\"input\",{type:\"password\",onChange:function onChange(e){return setPassword(e.target.value);},placeholder:\"Enter password\",style:styles.input}),/*#__PURE__*/React.createElement(\"button\",{style:styles.button,onClick:function onClick(e){return e.preventDefault()|handleLogin();}},\"Login as presenter\"),/*#__PURE__*/React.createElement(\"button\",{style:styles.button,onClick:function onClick(){return window.location.href='?present=no';}},\"View Only\")),/*#__PURE__*/React.createElement(\"div\",null));return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{style:styles.counter},slideIndex+1,\"/\",slides.length),/*#__PURE__*/React.createElement(\"div\",{style:styles.imgContainer},(slides||[]).map(function(slide,index){return/*#__PURE__*/React.createElement(\"img\",{src:\"./slides/\".concat(slide),style:{display:slideIndex!==index?'none':'block',width:'100%'},alt:slide});})));}var styles={button:{background:'#dadada',cursor:'pointer',fontWeight:'bold',padding:'10px 15px'},counter:{position:'fixed',top:25,left:25,fontWeight:'bold',color:'grey'},imgContainer:{height:'100%',width:'100%',overflow:'hidden'},input:{padding:'10px 15px',borderRadius:3,border:'1px solid grey'}};// getUrlParam reads the URL parameters\n//\n// Params:\n// @name    string: (optional) if supplied will return a specific paramenter as string.\n//                  Otherwise, will return an object containing all the URL parameters with respective values.\n//\n// returns  string/object\nfunction getUrlParam(name){var params={};var regex=/[?&]+([^=&]+)=([^&]*)/gi;window.location.href.replace(regex,function(_,key,value){return params[key]=value;});return name?params[name]||'':params;}// deferred returns a function that invokes the callback function after certain delay/timeout\n// If the returned function is invoked again before timeout,\n// the invokation will be deferred further with the duration supplied in @delay\n//\n// Params:\n// @callback  function  : function to be invoked after deferred delay\n// @delay     number    : number of milliseconds to be delayed.\n//                        Default value: 50\n// @thisArg    object   : optional, makes sure callback is bounded to supplied object \nexport function deferred(callback,delay,thisArg){var timeoutId;return function(){var args=arguments;if(timeoutId)clearTimeout(timeoutId);timeoutId=setTimeout(function(){callback&&callback.apply(thisArg,args);},delay||50);};}function setupKeyHandler(numSlides){document.onkeydown=function(e){// control slide on arrow key press and page up/down key press\ne=e||window.event;var index=window.slideIndex;switch(e.keyCode){case 35:// End key\nindex=numSlides-1;// go to last slide\nbreak;case 36:// Home key\nindex=0;// go to first slide\nbreak;case 38:// up arrow\ncase 37:// left arrow\nindex--;// go to previous slide\nbreak;case 39:// right arrow\ncase 40:// down arrow\nindex++;// go to next slide\nbreak;default:// console.log({ keyCode: e.keyCode })\nbreak;}if(index<0||index>=numSlides)return;client.setCurrentSlide(index,function(err){return err&&console.log('setCurrentSlide',{err:err});});};}","map":{"version":3,"sources":["/home/toufiq/go/src/github.com/play-around/presenter/src/App.js"],"names":["React","useState","useEffect","client","App","localStorage","getItem","password","setPassword","slideIndex","setSlideIndexOrg","slides","setSlides","isPresenter","setIsPresenter","DO_PRESENT","getUrlParam","toLowerCase","setSlideIndex","index","window","handleLogin","deferred","login","_","admin","setItem","setupKeyHandler","length","onSlideIndex","console","log","onReconnect","getSlides","textAlign","e","preventDefault","target","value","styles","input","button","location","href","counter","imgContainer","map","slide","src","style","display","width","alt","background","cursor","fontWeight","padding","position","top","left","color","height","overflow","borderRadius","border","name","params","regex","replace","key","callback","delay","thisArg","timeoutId","args","arguments","clearTimeout","setTimeout","apply","numSlides","document","onkeydown","event","keyCode","setCurrentSlide","err"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport client from './client'\nimport './App.css'\n\nexport default function App() {\n\tconst [password, setPassword] = useState(localStorage.getItem('password'))\n\tconst [slideIndex, setSlideIndexOrg] = useState(0)\n\tconst [slides, setSlides] = useState([]) // slide names\n\tconst [isPresenter, setIsPresenter] = useState(false)\n\tconst DO_PRESENT = getUrlParam('present').toLowerCase() === 'yes'\n\tconst setSlideIndex = index => {\n\t\twindow.slideIndex = index\n\t\tsetSlideIndexOrg(index)\n\t}\n\tconst handleLogin = deferred(() => {\n\t\tclient.login(password, (_, admin, slides, index) => {\n\t\t\tif (password) {\n\t\t\t\tsetIsPresenter(admin)\n\t\t\t\tif (admin) {\n\t\t\t\t\tlocalStorage.setItem('password', password)\n\t\t\t\t\tsetupKeyHandler(slides.length)\n\t\t\t\t}\n\t\t\t}\n\t\t\tsetSlides(slides || [])\n\t\t\tsetSlideIndex(index)\n\t\t})\n\t}, 100)\n\n\tuseEffect(() => {\n\t\thandleLogin()\n\t\tclient.onSlideIndex((index) => {\n\t\t\tsetSlideIndex(index)\n\t\t\tconsole.log('Slide changed', index)\n\t\t})\n\n\t\tclient.onReconnect(() => {\n\t\t\tslides.length === 0 && client.getSlides(slides => setSlides(slides || []))\n\t\t\tisPresenter && password && handleLogin()\n\t\t})\n\t\treturn () => { }\n\t}, [])\n\n\tif (DO_PRESENT && !isPresenter && !localStorage.getItem('password')) return (\n\t\t<div style={{ textAlign: 'center' }}>\n\t\t\t<h3>Please enter password to login</h3>\n\t\t\t<form onSubmit={e => e.preventDefault() | handleLogin()}>\n\t\t\t\t<input\n\t\t\t\t\ttype='password'\n\t\t\t\t\tonChange={e => setPassword(e.target.value)}\n\t\t\t\t\tplaceholder='Enter password'\n\t\t\t\t\tstyle={styles.input}\n\t\t\t\t/>\n\t\t\t\t<button\n\t\t\t\t\tstyle={styles.button}\n\t\t\t\t\tonClick={e => e.preventDefault() | handleLogin()}\n\t\t\t\t>\n\t\t\t\t\tLogin as presenter\n\t\t\t\t\t</button>\n\t\t\t\t<button\n\t\t\t\t\tstyle={styles.button}\n\t\t\t\t\tonClick={() => window.location.href = '?present=no'}\n\t\t\t\t>\n\t\t\t\t\tView Only\n\t\t\t\t</button>\n\t\t\t</form>\n\t\t\t<div>\n\t\t\t</div>\n\t\t</div>\n\t)\n\treturn (\n\t\t<div>\n\t\t\t<div style={styles.counter}>\n\t\t\t\t{slideIndex + 1}/{slides.length}\n\t\t\t</div>\n\t\t\t<div style={styles.imgContainer}>\n\t\t\t\t{(slides || []).map((slide, index) => (\n\t\t\t\t\t<img {...{\n\t\t\t\t\t\tsrc: `./slides/${slide}`,\n\t\t\t\t\t\tstyle: {\n\t\t\t\t\t\t\tdisplay: slideIndex !== index ? 'none' : 'block',\n\t\t\t\t\t\t\twidth: '100%',\n\t\t\t\t\t\t},\n\t\t\t\t\t\talt: slide,\n\t\t\t\t\t}} />\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t)\n}\n\nconst styles = {\n\tbutton: {\n\t\tbackground: '#dadada',\n\t\tcursor: 'pointer',\n\t\tfontWeight: 'bold',\n\t\tpadding: '10px 15px',\n\t},\n\tcounter: {\n\t\tposition: 'fixed',\n\t\ttop: 25,\n\t\tleft: 25,\n\t\tfontWeight: 'bold',\n\t\tcolor: 'grey',\n\t},\n\timgContainer: {\n\t\theight: '100%',\n\t\twidth: '100%',\n\t\toverflow: 'hidden',\n\t},\n\tinput: {\n\t\tpadding: '10px 15px',\n\t\tborderRadius: 3,\n\t\tborder: '1px solid grey'\n\t},\n}\n\n// getUrlParam reads the URL parameters\n//\n// Params:\n// @name    string: (optional) if supplied will return a specific paramenter as string.\n//                  Otherwise, will return an object containing all the URL parameters with respective values.\n//\n// returns  string/object\nfunction getUrlParam(name) {\n\tconst params = {}\n\tconst regex = /[?&]+([^=&]+)=([^&]*)/gi\n\twindow.location.href.replace(regex, (_, key, value) => params[key] = value)\n\treturn name ? params[name] || '' : params\n}\n\n// deferred returns a function that invokes the callback function after certain delay/timeout\n// If the returned function is invoked again before timeout,\n// the invokation will be deferred further with the duration supplied in @delay\n//\n// Params:\n// @callback  function  : function to be invoked after deferred delay\n// @delay     number    : number of milliseconds to be delayed.\n//                        Default value: 50\n// @thisArg    object   : optional, makes sure callback is bounded to supplied object \nexport function deferred(callback, delay, thisArg) {\n\tlet timeoutId\n\treturn function () {\n\t\tconst args = arguments\n\t\tif (timeoutId) clearTimeout(timeoutId)\n\t\ttimeoutId = setTimeout(function () {\n\t\t\tcallback && callback.apply(thisArg, args)\n\t\t}, delay || 50)\n\t}\n}\n\nfunction setupKeyHandler(numSlides) {\n\tdocument.onkeydown = e => {\n\t\t// control slide on arrow key press and page up/down key press\n\t\te = e || window.event;\n\t\tlet index = window.slideIndex\n\t\tswitch (e.keyCode) {\n\t\t\tcase 35: // End key\n\t\t\t\tindex = numSlides - 1 // go to last slide\n\t\t\t\tbreak\n\t\t\tcase 36: // Home key\n\t\t\t\tindex = 0 // go to first slide\n\t\t\t\tbreak\n\t\t\tcase 38: // up arrow\n\t\t\tcase 37: // left arrow\n\t\t\t\tindex-- // go to previous slide\n\t\t\t\tbreak\n\t\t\tcase 39: // right arrow\n\t\t\tcase 40: // down arrow\n\t\t\t\tindex++ // go to next slide\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\t// console.log({ keyCode: e.keyCode })\n\t\t\t\tbreak\n\t\t}\n\t\tif (index < 0 || index >= numSlides) return\n\t\tclient.setCurrentSlide(index, err => err && console.log('setCurrentSlide', { err }))\n\t}\n}"]},"metadata":{},"sourceType":"module"}